<!DOCTYPE html>
<html lang="en">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>

  Redirecting AJAX requests in Rails · Máximo Mussini

</title>
<meta name="author" content="Máximo Mussini">
<meta name="description" content="">
<meta name="keywords" content="">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="cleartype" content="on">

<!-- Styles -->
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Raleway:700,800,900|Lato:300,300italic,400,400italic,700,900" type="text/css">
<link rel="stylesheet" href="/assets/css/styles.css" media="screen, projection">

<!-- Icons -->
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" href="/apple-touch-icon.jpg">
<link rel="alternate" type="application/atom+xml" href="/feed.xml" title="Máximo Mussini · Code and Design">

<!-- Facebook Stuff -->
<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:url" content="http://maximomussini.com/posts/rails-ajax_redirect">
<meta property="og:site_name" content="Máximo Mussini">
<meta property="og:title" content="Redirecting AJAX requests in Rails">
<meta property="og:image" content="http://maximomussini.com/images/posts/rails-ajax_redirect.jpg">
<meta property="og:description" content="jquery-rails powers links and forms in Rails: it’s what makes remote: true work, allowing any link to make an AJAX request unobtrusively.

rails-ajax_redirect is an extension to this unobtrusive behaviour that adds AJAX support to redirect_to. It allows us to redirect an AJAX request as usual, instead of having to perform the redirect by handling the response manually in JS every time.

This is helpful in many different scenarios, and ju…">

<!-- Twitter Stuff -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:domain" value="maximomussini.com" />
<meta name="twitter:title" value="Redirecting AJAX requests in Rails" />
<meta name="twitter:description" value="jquery-rails powers links and forms in Rails: it’s what makes remote: true work, allowing any link to make an AJAX request unobtrusively.

rails-ajax_redirect is an extension to this unobtrusive behaviour that adds AJAX support to redirect_to. It allows us to redirect an AJAX request as usual, instead of having to perform the redirect by handling the response manually in JS every time.

This is helpful in many different scenarios, and ju…" />
<meta name="twitter:image" content="http://maximomussini.com/images/posts/rails-ajax_redirect.jpg" />
<meta name="twitter:url" value="http://maximomussini.com/posts/rails-ajax_redirect" />

  <body>
    <header>
  
    <div class="hero" style="background-image: url(/images/posts/rails-ajax_redirect.jpg)">
      <h1>Redirecting AJAX requests in Rails</h1>
    </div>
  
</header>

    <div class="menu container">
  <ul>
    
<li>
  <a href="/about/">About</a>
</li>

    
<li>
  <a href="/posts/">Posts</a>
</li>

    <li>
      <a href="/" class="logo">
  <span class="text">M</span>
</a>

    </li>
    
<li>
  <a href="/projects/">Projects</a>
</li>

    
<li>
  <a href="/talks/">Talks</a>
</li>

  </ul>
  <hr />
</div>

    <div class="content container">
  

  <div class="post-info">
  <span class="date">January 11, 2016</span>
  <span class="reading-time">2 min read</span>
</div>


  <div class="post">
    <p><a href="https://github.com/rails/jquery-rails"><code>jquery-rails</code></a> powers links and forms in Rails: it’s what makes <code>remote: true</code> work, allowing any link to make an AJAX request unobtrusively.</p>

<p><a href="https://github.com/ElMassimo/rails-ajax_redirect"><code>rails-ajax_redirect</code></a> is an extension to this unobtrusive behaviour that adds AJAX support to <code>redirect_to</code>. It allows us to redirect an AJAX request as usual, instead of having to perform the redirect by handling the response manually in JS every time.</p>

<p>This is helpful in many different scenarios, and just like <code>remote: true</code>, it allows us to skip some of the boilerplate in cases where we need to redirect the user to a different page.</p>

<p><a href="https://github.com/ElMassimo/rails-ajax_redirect"><code>Rails::AjaxRedirect</code></a> extends <code>redirect_to</code> to use a custom status code for ajax
requests, while still setting the <code>Location</code> header. On the front-end, it adds a handler for the <code>ajax:success</code> event, that navigates to the location in the header for responses that have the custom status code.</p>

<p>This makes it possible to write a simple redirect as usual, but without having to handle it manually every time <img class="emoji" title=":smiley:" alt=":smiley:" src="https://assets.github.com/images/icons/emoji/unicode/1f603.png" height="20" width="20" align="absmiddle" /></p>

<h2 id="turbolinks">Turbolinks</h2>
<p>If your application uses <a href="https://github.com/rails/turbolinks"><em>Turbolinks</em></a> check out <a href="https://github.com/remind101/turbolinks-redirect"><code>turbolinks-redirect</code></a>, on which <a href="https://github.com/ElMassimo/rails-ajax_redirect"><code>rails-ajax_redirect</code></a> is based on. The advantage is that it will perform faster navigation by leveraging <em>Turbolinks</em> to visit the new location.</p>

<h2 id="angularjs">AngularJS</h2>
<p>If your application makes the AJAX request using <code>$http</code> instead of <code>jQuery</code>, it will be necessary to add an interceptor similar to this:</p>

<div class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript"><span class="nx">app</span><span class="p">.</span><span class="nx">config</span> <span class="nf">($httpProvider) -&gt;</span>
  <span class="nx">$httpProvider</span><span class="p">.</span><span class="nx">interceptors</span><span class="p">.</span><span class="nx">push</span> <span class="s">&#39;AjaxRedirectInterceptor&#39;</span>

  <span class="c1"># Add a header to let Rails know that it&#39;s an Ajax request.</span>
  <span class="nx">$httpProvider</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">common</span><span class="p">[</span><span class="s">&#39;X-REQUESTED-WITH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;XMLHttpRequest&#39;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">service</span> <span class="s">&#39;AjaxRedirectInterceptor&#39;</span><span class="p">,</span> <span class="nf">($window, $location, $q) -&gt;</span>
  <span class="nv">interceptor =</span>
    <span class="nv">response: </span><span class="nf">(response) -&gt;</span>
      <span class="k">if</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">is</span> <span class="nx">AJAX_REDIRECT_STATUS_CODE</span>
        <span class="nv">$window.location = </span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">().</span><span class="nx">location</span>
        <span class="nx">$q</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="nx">response</span></code></pre></div>


  </div>

  <div class="ending">
  <div class="author">
    <a href="/" class="logo">
  <span class="text">M</span>
</a>

    By
    <a href="https://twitter.com/MaximoMussini" class="author-name short">@Maximo</a>
    <a href="https://twitter.com/MaximoMussini" class="author-name full">@MaximoMussini</a>
    <a href="https://twitter.com/share" class="twitter-share-button" data-via="MaximoMussini" data-dnt="true">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  </div>
</div>

</div>



  <a id="next-post" href="/posts/cucumber-to_or_not_to/" class="hidden"></a>




  <div class="previous-post">
    <div class="content container">
      <a id="previous-post" href="/posts/anko-vs-android-xml/" class="overlay">
        <h1>Anko DSL vs Android XML-First</h1>
        <div class="post-info">
  <span class="date">January 04, 2016</span>
  <span class="reading-time">5 min read</span>
</div>

        <div class="post">
          <p><span href="https://github.com/kotlin/anko"><em>Anko</em></span> is a library for <em>Android</em> development in <span href="https://kotlinlang.org"><em>Kotlin</em></span>. The library provides helper methods that take advantage of <em>Kotlin</em>’s extension functions as a way to reduce the amount of boilerplate the <em>Android SDK</em> requires. Those extension functions make it possible to accomplish common tasks like starting an activity or displaying a toast in a very succinct way.</p>

<p>A big part of…</p>
        </div>
      </a>
    </div>
  </div>



    <script>
if (document.location.hostname.search('maximomussini.com') !== -1) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-67510525-1', 'auto');
  ga('send', 'pageview');
}
</script>

<script src="/assets/js/anchors.js"></script>
<script src="/assets/js/shortcuts.js"></script>

  </body>
</html>
